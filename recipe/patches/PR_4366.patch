From b09cf95e1d9dcf5db26d511520d1ddf3a1d9fdcb Mon Sep 17 00:00:00 2001
From: Devendar Bureddy <devendar@mellanox.com>
Date: Thu, 31 Oct 2019 23:30:57 +0200
Subject: [PATCH] UCT/CUDA_IPC: Fix peer_accessible check

---
 src/uct/cuda/cuda_ipc/cuda_ipc_md.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/uct/cuda/cuda_ipc/cuda_ipc_md.c b/src/uct/cuda/cuda_ipc/cuda_ipc_md.c
index 5f384d3cf5..923629eb31 100644
--- a/src/uct/cuda/cuda_ipc/cuda_ipc_md.c
+++ b/src/uct/cuda/cuda_ipc/cuda_ipc_md.c
@@ -131,7 +131,7 @@ static ucs_status_t uct_cuda_ipc_is_peer_accessible(uct_cuda_ipc_component_t *md
     UCT_CUDA_IPC_DEVICE_GET_COUNT(num_devices);
 
     accessible = &mdc->md->peer_accessible_cache[peer_idx * num_devices + this_device];
-    if (*accessible == -1) { /* unchecked, add to cache */
+    if (*accessible == (char)0xFF) { /* unchecked, add to cache */
         /* rkey->d_mapped is picked up in uct_cuda_ipc_cache_map_memhandle */
         CUresult result = cuIpcOpenMemHandle(&rkey->d_mapped,
                                              rkey->ph,
